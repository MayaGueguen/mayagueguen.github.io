---
title: "DIVERSITY traits : imputation"
date: "26/10/2020"
output:
  html_document:
    number_sections: no
    toc: yes
    toc_float:
      collapsed: false
      smooth_scroll: false
---	


```{r, echo=FALSE}
library(knitr)
```

<br/>
<br/>

# Specific traits

## 2014 : Tamme (Ecology)

*Measure the predictive power of simple plant traits to estimate species’ maximum dispersal distances :*

- dispersal distance is related **to a dispersal syndrome** (Willson 1993, Pärtel and Zobel 2007, Vittoz and Engler 2007),  
that may generally be deduced from seed morphology
- but difficult to establish a direct association (Nogales et al. 2007)
- **plant height** is more important than seed mass in determining seed dispersal distances (Thomson et al. 2011)
- **maximum dispersal distance is strongly correlated with mean dispersal distance** (Thomson et al. 2011) :

$$ log_{10}(\text{ maximumDist }) = 0.795 + 0.984 * log_{10}(\text{ meanDist })$$

<br/>

<div style="text-align:center;">
$\Rightarrow$ **(dispersal syndrome + growth form + terminal velocity)**  
explain $\sim$ 60$\%$ of the variation in maximum dispersal distances

$\Rightarrow$ **(dispersal syndrome + growth form)**  
explain $\sim$ 50$\%$ of the variation in maximum dispersal distances
</div>

with

* on average, maximum dispersal distances increase from :  
<div style="text-align:center;">
wind (no special mechanisms) < ballistic < ant < wind (special mechanisms) < animal  
herb < shrub < tree
</div>
* models with terminal velocity only apply to species with wind or ballistic dispersal syndrome
* in general, overestimates for species with short-distance dispersal and underestimates for species with long-distance dispersal

<div style="text-align:center;">
$\Rightarrow$ **`dispeRsal` package**
</div>

<br/><br/>

# Imputation methods

## 1999 : Schaffer

Single imputations have been shown to be accurate for datasets with small percentages of missing values.

## 2011 : Azur (MICE)

## 2012 : Shan (HPMF)

## 2015 : Schrodt (BHPMF)

## 2017 : Goolsby (Rphylopars)

## 2019 : Quartagno (jomo)

<br/><br/>


# Comparison of methods

| PAPERS | No families | No species | No traits (response) | No traits (used) | No methods |
|--------------|--------------|--------------|--------------|--------------|--------------|
|  Tamme (2014) | 102 | 576 | 1 (max disp dist) | 5 | 1 (relationship) |
|  Taugourdeau (2014) |  | 1054 | 9 |  | 5 (mean and median, dissimilarity, relationship, mice) |
|  Penone (2014) |  | 273 | 4 |  | 4 (kNN, mice, missForest, Phylopars) |
|  Schrodt (2015) | 358 | 14320 | 13 |  | 3 (PMF, BHMPF, aHMPF) |
|  Poyatos (2018) | 4 | 13 | 5 |  | 6 (mean and species mean, ordinary and regression kriging, kNN, mice) |
|  Johnson (2020) |  | 500 (simulated) | 1 | 4 | 9 (BHMPF, Rphylopars, mice) |

<br/><br/>


| METHODS | Positive points | Negative points |
|--------------|--------------|--------------|
| Complete-case | | |
| Mean / species mean / median | | |
| kNN | | |
| relationship | | |
| dissimilarity | | |
| BHMPF | | |
| (R)phylopars | | |
| MICE | | |


## 2014 : Taugourdeau

*Effect of imputation methods on the evaluation of trait values at species level and on the subsequent calculation of functional diversity indices at community level :*

- Single imputation (mathematical methods) : average / median
- Single imputation (ecological hypotheses) : dissimilarity / relationships
- Multiple imputation : MICE

<br/>

<div style="text-align:center;">
$\Rightarrow$ key parameter to choose the adequate imputation method = the distribution of the trait value in the dataset
</div>

- **Average method** = least accurate

- **Functional proximity between species** =
    - best method for traits with *unbalanced distribution*
    - but would not be an appropriate choice for a study on functional distance between species,  
    as functional distance would then be underestimated
    - less affected by the percentage of deleted data (but Gower dissimilarity cannot be calculated between two species if no trait for both species, and so the correction would not be possible if missing data are too numerous)


- **Relationships between traits** =
    - best method for traits with *balanced distribution*
    - but the most sensitive to the level of missing data

$\Rightarrow$ at the species level, the most accurate imputation method is NOT THE SAME for all traits and in all cases,  
BUT dissimilarity and/or relationships methods always the most accurate AMONG the single imputation methods

- **MICE** = more accurate than all other methods for all traits except SLA
    - the correction model can be adapted to the distribution of the variable, but caution with unbalanced traits ??



<br/>

## 2014 : Penone

*Evaluate the performance of four approaches for estimating missing values in trait databases and test whether imputed datasets retain underlying allometric relationships among traits :*

- Single imputation : k-Nearest Neighbour (kNN, package `VIM`) with average / median
- Single imputation : random forest algorithms : package `missForest`
- Single imputation : likelihood-based approach (`Phylopars`) using both phylogeny and allometric relationships among traits (phylogenetic variance-covariance matrix)
- Multiple imputation : MICE (package `mice`) with predictive mean matching



mice, missForest and Phylopars), resulted in qualitatively equivalent imputa- tion performance, and all had significantly lower errors than kNN. Adding phylogenetic information into the imputation algorithms improved estimation of missing values for all tested traits. The

<br/>

## 2015 : Schrodt

<br/>

## 2018 : Poyatos


<br/>
<br/>


# Glossary

- **Distribution of missing data** = 
    - MCAR = missing completely at random
    - MAR = missing at random (when the presence of missing data for a given variable is related to the values of another variable)
    - MNAR = missing not at random

$\Rightarrow$ in functional trait databases, missingness is related to the frequency of the species and their abundances, and taxonomic and phylogenetic bias is commonplace $/!\setminus$

<br/>

- **Deletion method** =
    - delete species with missing data for the calculation of diversity indices
    - acceptable for estimation of the community-weighted mean trait value (CWM)  
    as long as it only concerns the minor species (should not exceed 20$\%$ of the total biomass of the community)

<br/>

- **Gower + PCoA** =
    - compute Gower distance (with missing data) and project the distance with a Principal Coordinate Analysis,  
    the axes being then used as functional traits
    - only relevant for functional diversity indices calculated from several traits
    - trait information gets lost and only multivariate approaches can be used

<br/>

- **Imputation method** = replace missing data with substituted values

<br/>

- **Single imputation** =
    - Replace with the mean or the median of the available trait values
    - Functional proximity between species (species with the same functional strategy have a similar set of functional traits) (Westoby et al. 2002, Diaz et al. 2004)
    - Relationships between traits (Wrigth et al. 2004, 2006)
- **Multiple imputation** =
    - Monte Carlo technique in which the missing values are replaced by $m > 1$ imputed values,  
        combined to produce estimates, confidence intervals, missing data uncertainty (Nakagawa and Freckleton 2008)
    - Hierarchical probabilistic matrix factorization coupled with phylogenetic information
    - Multivariate imputation by chained equations (MICE, Azur et al. 2011)


<br/>
<br/>


# Citations

- Allen, B., Kon, M., Bar‐Yam, Y., Associate Editor: Ross H. Crozier, & Editor: Monica A. Geber. (2009). A New Phylogenetic Diversity Measure Generalizing the Shannon Index and Its Application to Phyllostomid Bats. The American Naturalist, 174(2), 236-243. https://doi.org/10.1086/600101
- 

